{"version":3,"sources":["../../src/server/server-route-utils.ts"],"names":["getRedirectStatus","modifyRouteRegex","getPathMatch","compileNonPath","prepareDestination","getRequestMeta","stringify","stringifyQs","format","formatUrl","normalizeRepeatedSlashes","getCustomRoute","params","rule","type","restrictedRedirectPaths","match","source","strict","removeUnnamedParams","regexModifier","internal","regex","undefined","name","fn","_req","_res","_params","_parsedUrl","finished","createHeaderRoute","headerRoute","matchesBasePath","matchesLocale","matchesLocaleAPIRoutes","matchesTrailingSlash","has","missing","res","hasParams","Object","keys","length","header","headers","key","value","setHeader","stringifyQuery","req","query","initialQuery","initialQueryValues","values","encodeURIComponent","some","initialQueryVal","Array","isArray","includes","createRedirectRoute","redirectRoute","statusCode","parsedUrl","parsedDestination","appendParamsToQuery","destination","search","updatedDestination","startsWith","redirect","body","send"],"mappings":"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"}