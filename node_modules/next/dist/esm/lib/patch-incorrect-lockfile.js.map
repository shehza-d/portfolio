{"version":3,"sources":["../../src/lib/patch-incorrect-lockfile.ts"],"names":["promises","Log","findUp","nextPkgJson","isCI","getRegistry","registry","fetchPkgInfo","pkg","res","fetch","ok","Error","status","data","json","versionData","versions","version","os","cpu","engines","tarball","dist","integrity","patchIncorrectLockfile","dir","process","env","NEXT_IGNORE_INCORRECT_LOCKFILE","lockfilePath","cwd","content","readFile","endingNewline","endsWith","lockfileParsed","JSON","parse","lockfileVersion","parseInt","expectedSwcPkgs","Object","keys","optionalDependencies","patchDependency","pkgData","dependencies","resolved","optional","patchPackage","packages","supportedVersions","includes","shouldPatchDependencies","shouldPatchPackages","missingSwcPkgs","pkgPrefix","substring","length","push","warn","pkgsData","Promise","all","map","i","writeFile","stringify","err","error","console"],"mappings":"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"}