{"version":3,"sources":["../../../../src/server/lib/incremental-cache/fetch-cache.ts"],"names":["FetchCache","constructor","ctx","maxMemoryCacheSize","memoryCache","LRUCache","max","length","value","JSON","kind","stringify","props","Error","data","body","html","pageData","debug","process","env","NEXT_PRIVATE_DEBUG_CACHE","headers","FETCH_CACHE_HEADER","_requestHeaders","newHeaders","parse","k","cacheEndpoint","console","log","get","key","fetchCache","start","Date","now","res","fetch","method","next","internal","status","ok","error","text","cached","json","cacheState","age","lastModified","CACHE_ONE_YEAR","parseInt","Object","keys","set","err","revalidate","toString"],"mappings":"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"}