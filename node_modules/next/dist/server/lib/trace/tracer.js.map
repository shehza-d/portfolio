{"version":3,"sources":["../../../../src/server/lib/trace/tracer.ts"],"names":["api","require","err","context","trace","SpanStatusCode","SpanKind","isPromise","p","then","closeSpanWithError","span","error","setStatus","code","ERROR","message","end","NextTracerImpl","getTracerInstance","getTracer","getContext","getActiveScopeSpan","getSpan","active","args","name","fnOrOptions","fnOrEmpty","fn","options","NextVanillaSpanAllowlist","includes","process","env","NEXT_OTEL_VERBOSE","spanContext","getSpanContext","parentSpan","runWithContext","actualFn","startActiveSpan","length","result","wrap","tracer","optionsObj","apply","arguments","lastArgId","cb","scopeBoundCb","bind","_span","done","startSpan","setSpan","undefined"],"mappings":"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"}